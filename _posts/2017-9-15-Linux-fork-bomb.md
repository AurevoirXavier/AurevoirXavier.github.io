---
layout: post
title: "Linux fork bomb"
date:   2017-09-15
excerpt: "Linux fork 炸弹"
tags: [Note]
comments: true
---

<center><h2>Linux fork 炸弹</h2></center>

<!--more-->

Jaromil 在 2002 年设计了最为精简的一个 fork 炸弹的实现。fork 炸弹是一种恶意程序，它的内部有一个在不断 fork 进程的无限循环，fork 炸弹并不需要有特别的权限即可对系统造成破坏。fork 炸弹其实就是一个递归程序。由于程序是递归的，如果没有任何限制，这个简单的程序可以轻而易举的耗尽系统里面的所有资源。来一探究竟吧:

```shell
//    第一种
:() { :|:& };:
//    第二种
.() { .|.& };.
```

只有 13 个字符的命令，即可占用掉所有系统的资源。其实，写成 bash script 就很好理解了：

```shell
:()
{
:|: &
}
;
:
```

* 第 1 行：下面要定义一个函数，函数名为小数点，没有可选参数。
* 第 2 行：函数体开始。
* 第 3 行：函数要做的事情，首先递归调用本函数，然后利用管道调用一个新进程 (做的事情也是递归调用本函数) ，并将其放到后台执行。
* 第 4 行：函数体结束。
* 第 5 行：在命令行中用来分隔两个命令用。表明这段程序有两个部分，前者定义一个函数，后者调用这个函数。
* 第 6 行：调用函数。

`:` 其实是函数名，这个 bash 脚本就是在不断的执行该函数，然后不断 fork 新进程。

对于函数名，大家可能会有所疑惑，第二种写法里的小数点也能做函数名使用吗？

因为小数点是 shell 的一个内嵌命令，用来在当前 shell 环境中读取指定 文件，并运行其中的命令。实际上的确可以，这取决于 bash 对命令的解释顺序。

至于如何采取保护措施，限制进程数量是个不错的方法。

如果你想了解更多的可以前往 [wikipedia - fork bomb](https://en.wikipedia.org/wiki/Fork_bomb)。